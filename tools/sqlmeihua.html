---
layout: null
title: "SQLç¾åŒ–"
description: "SQLè¯­å¥æ’ç‰ˆç¾åŒ–ï¼ˆå¸¦åŸºç¡€è¯­æ³•æ ¡éªŒä¸é«˜äº®ï¼‰"
---
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ğŸ§© SQLç¾åŒ–</title>
    <style>
        :root {
            --bg: #1e1e1e;
            --panel: #252526;
            --err-color: #f44336;
            --warn-color: #ff9800;
        }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; background: #f0f2f5; }
        header { background: #fff; padding: 10px 20px; border-bottom: 1px solid #ddd; display: flex; align-items: center; gap: 20px; }
        .main { display: flex; flex: 1; padding: 20px; gap: 15px; overflow: hidden; }
        .column { flex: 1; display: flex; flex-direction: column; background: var(--panel); border-radius: 8px; position: relative; }
        .label { padding: 8px 15px; color: #aaa; font-size: 11px; font-weight: bold; border-bottom: 1px solid #333; }
        textarea, .display { flex: 1; border: none; padding: 15px; font-family: 'Consolas', monospace; font-size: 14px; line-height: 1.6; outline: none; overflow-y: auto; color: #d4d4d4; }
        textarea { background: transparent; resize: none; }
        .display { white-space: pre-wrap; background: var(--bg); }
        
        /* é”™è¯¯æç¤º */
        .error-overlay { background: #fffbe6; border-left: 4px solid var(--warn-color); padding: 10px; font-size: 13px; color: #856404; margin: 0 20px 20px; border-radius: 4px; display: none; }
        .error-overlay.active { display: block; }
        .err-underline { text-decoration: underline wavy var(--err-color); color: var(--err-color); font-weight: bold; }
        
        /* é«˜äº® */
        .hl-key { color: #569cd6; font-weight: bold; }
        .hl-str { color: #ce9178; }
        .hl-num { color: #b5cea8; }
        .hl-err { background: rgba(244, 67, 54, 0.3); border-bottom: 2px dotted red; }
    </style>
</head>
<body>

<header>
    <h2 style="margin:0; font-size: 18px;">ğŸ§© SQLç¾åŒ–</h2>
    <div id="status-tag" style="font-size: 12px; color: #666;">çŠ¶æ€: ç­‰å¾…è¾“å…¥...</div>
    <a href="/tools/" style="margin-left: auto; text-decoration: none; font-size: 16px; color: #333;">ğŸ”™ æ›´å¤šå·¥å…·</a>
</header>

<div class="main">
    <div class="column">
        <div class="label">è¾“å…¥åŸå§‹ SQL (æ”¯æŒè‡ªåŠ¨æ£€æµ‹é”™è¯¯)</div>
        <textarea id="input" placeholder="è¾“å…¥ SQL... è¯•è¯•è¾“å…¥ä¸­æ–‡é€—å·ï¼Œæˆ–è€…å°‘å†™ä¸€ä¸ªæ‹¬å·"></textarea>
    </div>
    <div class="column">
        <div class="label">æ ¡éªŒç»“æœä¸æ ‡æ³¨</div>
        <div id="output" class="display"></div>
    </div>
</div>

<div id="error-box" class="error-overlay"></div>

<script>
    const inputEl = document.getElementById('input');
    const outputEl = document.getElementById('output');
    const errorBox = document.getElementById('error-box');
    const statusTag = document.getElementById('status-tag');

    function validateAndFormat() {
        let sql = inputEl.value;
        if (!sql) {
            outputEl.innerHTML = "";
            errorBox.classList.remove('active');
            return;
        }

        let errors = [];
        let html = sql;

        // 1. æ£€æŸ¥ä¸­æ–‡å­—ç¬¦ï¼ˆéæ³•å­—ç¬¦æ£€æµ‹ï¼‰
        const chineseChars = /[ï¼Œã€‚ï¼›ï¼ˆï¼‰â€œâ€]/g;
        if (chineseChars.test(sql)) {
            errors.push("æ£€æµ‹åˆ°ä¸­æ–‡æ ‡ç‚¹ç¬¦å·ï¼ˆå¦‚ ï¼Œ æˆ– ï¼›ï¼‰ï¼Œè¯·åˆ‡æ¢ä¸ºè‹±æ–‡è¾“å…¥æ³•ã€‚");
            html = html.replace(chineseChars, match => `<span class="err-underline">${match}</span>`);
        }

        // 2. æ‹¬å·åŒ¹é…æ£€æŸ¥
        let stack = [];
        for (let i = 0; i < sql.length; i++) {
            if (sql[i] === '(') stack.push(i);
            else if (sql[i] === ')') {
                if (stack.length === 0) errors.push("æ£€æµ‹åˆ°å¤šä½™çš„å³æ‹¬å· ')'");
                else stack.pop();
            }
        }
        if (stack.length > 0) errors.push(`æ£€æµ‹åˆ° ${stack.length} ä¸ªæœªé—­åˆçš„å·¦æ‹¬å· '('`);

        // 3. å¼•å·é—­åˆæ£€æŸ¥
        const singleQuotes = (sql.match(/'/g) || []).length;
        if (singleQuotes % 2 !== 0) errors.push("å•å¼•å· ' æœªæ­£ç¡®é—­åˆ");

        // 4. æ‚¬ç©ºæ“ä½œç¬¦æ£€æŸ¥
        if (/\b(AND|OR|WHERE|SELECT|,)\s*$/i.test(sql.trim())) {
            errors.push("è¯­å¥ä¼¼ä¹æœªå®Œæˆï¼Œä¸èƒ½ä»¥æ“ä½œç¬¦æˆ–é€—å·ç»“å°¾");
        }

        // æ‰§è¡Œç¾åŒ–å±•ç¤º
        renderResult(sql, errors);
    }

    function renderResult(rawSql, errors) {
        // ç®€å•çš„ç¾åŒ–ï¼šå…³é”®å­—æ¢è¡Œ + å¤§å†™
        const keywords = /\b(SELECT|FROM|WHERE|AND|OR|GROUP BY|ORDER BY|JOIN|INSERT|UPDATE|SET)\b/gi;
        
        let formatted = rawSql.replace(keywords, (m) => "\n" + m.toUpperCase() + " ");
        
        // è¯­æ³•é«˜äº®
        let highlighted = formatted
            .replace(/&/g, "&amp;").replace(/</g, "&lt;")
            .replace(keywords, '<span class="hl-key">$1</span>')
            .replace(/('.*?')/g, '<span class="hl-str">$1</span>')
            .replace(/\b(\d+)\b/g, '<span class="hl-num">$1</span>')
            // ç‰¹æ®Šå¤„ç†é”™è¯¯æ ‡æ³¨
            .replace(/[ï¼Œã€‚ï¼›ï¼ˆï¼‰â€œâ€]/g, '<span class="err-underline">$&</span>');

        outputEl.innerHTML = highlighted.trim();

        // æ›´æ–°é”™è¯¯æç¤ºæ¡†
        if (errors.length > 0) {
            statusTag.innerHTML = `âš ï¸ å‘ç° ${errors.length} ä¸ªæ½œåœ¨é—®é¢˜`;
            statusTag.style.color = "red";
            errorBox.innerHTML = "<strong>ä¿®æ”¹å»ºè®®ï¼š</strong><br/>â€¢ " + errors.join("<br/>â€¢ ");
            errorBox.classList.add('active');
        } else {
            statusTag.innerHTML = "âœ… è¯­æ³•è§£ææ­£å¸¸";
            statusTag.style.color = "green";
            errorBox.classList.remove('active');
        }
    }

    inputEl.addEventListener('input', validateAndFormat);

    // é¢„è®¾ä¸€ä¸ªé”™è¯¯çš„ä¾‹å­
    inputEl.value = "SELECT idï¼Œname FROM users WHERE id = 1 AND (status = 'active'";
    validateAndFormat();
</script>

</body>
</html>